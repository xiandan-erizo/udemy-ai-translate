# Udemy 字幕翻译扩展

这个 Chrome 扩展可以监听 Udemy 视频播放器中的新字幕行，将其发送给 OpenAI 进行翻译，并在页面上内联显示翻译后的文本。还可以选择在滚动时翻译转录面板的内容。

## 功能特点

- 实时翻译视频上显示的活动字幕提示（通过 HTML5 文本轨道 API）。
- 可选翻译转录列表项目。
- 切换显示/隐藏原始字幕文本。
- 可配置目标语言、API 基础 URL、模型、并发数、字幕字体大小/颜色，并安全地本地存储您的 OpenAI API 密钥。
- 持续 24 小时的翻译缓存，避免重复支付相同内容的费用，提供一键清除选项。
![alt text](image.png)
## 安装设置

1. **获取 OpenAI API 密钥** – 访问 [OpenAI 仪表板](https://platform.openai.com/) 并创建一个具有翻译功能模型访问权限的 API 密钥（例如 `gpt-4o-mini`）。
2. **加载扩展**：
   - 打开 `chrome://extensions`。
   - 启用 **开发者模式**（右上角）。
   - 选择 **加载已解压的扩展程序** 并选择此仓库中的 `chrome-extension` 文件夹。
3. **配置扩展**：
   - 点击扩展图标或选择 **详细信息 → 扩展程序选项**。
   - 粘贴您的 API 密钥（本地存储），如果使用代理/Azure 终端节点请设置 API 基础 URL，选择模型 ID，调整并发限制，自定义字幕字体大小和颜色，选择目标语言（默认：`zh-CN`），并调整显示开关。

配置完成后，在 Udemy 中打开视频。扩展会观察字幕区域和转录侧边栏，在新行出现时进行翻译。

## 注意事项

- 浏览会话期间会缓存翻译结果以避免重复的 OpenAI 请求。
- 字幕从视频文本轨道读取，因此 Udemy 上的 UI 类更改不太可能破坏集成。为翻译文本渲染了自定义覆盖层。
- 扩展通过附加翻译节点而不是替换原始标记来尊重 Udemy 的现有样式（仅在使用基于轨道的字幕时才显示自定义覆盖层）。
- 转录历史作为上下文发送，因此每条字幕都能与前几行一起翻译以保持连贯性。
- 如果想要更快的预翻译，可以增加并发请求，但较高的值更容易达到 OpenAI 的速率限制。
- 如果字幕停止翻译，请检查带有 `[Udemy Translator]` 前缀的 DevTools 控制台消息。常见原因包括缺失/无效的 API 密钥或达到 OpenAI 的速率限制。
- 缓存的翻译会在 24 小时后自动过期；如果您需要提前刷新，请使用选项页面中的 **清除翻译缓存** 按钮。

## 安全性

- 您的 API 密钥通过 `chrome.storage.local` 存储，保留在您的机器上，永不同步。
- 所有翻译请求都直接从后台服务工作者通过 HTTPS 发送到 OpenAI。